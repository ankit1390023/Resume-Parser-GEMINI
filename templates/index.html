<!DOCTYPE html>
<html lang="en">

    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <script src="https://cdn.tailwindcss.com"></script>
        <title>Resume Parser</title>

    </head>

    <body>
        <div class="relative isolate overflow-hidden bg-gray-900">
            <svg class="absolute inset-0 -z-10 h-full w-full stroke-white/10 [mask-image:radial-gradient(100%_100%_at_top_right,white,transparent)]"
                aria-hidden="true">
                <defs>
                    <pattern id="983e3e4c-de6d-4c3f-8d64-b9761d1534cc" width="200" height="200" x="50%" y="-1"
                        patternUnits="userSpaceOnUse">
                        <path d="M.5 200V.5H200" fill="none" />
                    </pattern>
                </defs>
                <svg x="50%" y="-1" class="overflow-visible fill-gray-800/20">
                    <path d="M-200 0h201v201h-201Z M600 0h201v201h-201Z M-400 600h201v201h-201Z M200 800h201v201h-201Z"
                        stroke-width="0" />
                </svg>
                <rect width="100%" height="100%" stroke-width="0" fill="url(#983e3e4c-de6d-4c3f-8d64-b9761d1534cc)" />
            </svg>
            <div class="absolute left-[calc(50%-4rem)] top-10 -z-10 transform-gpu blur-3xl sm:left-[calc(50%-18rem)] lg:left-48 lg:top-[calc(50%-30rem)] xl:left-[calc(50%-24rem)]"
                aria-hidden="true">
                <div class="aspect-[1108/632] w-[69.25rem] bg-gradient-to-r from-[#80caff] to-[#4f46e5] opacity-20"
                    style="clip-path: polygon(73.6% 51.7%, 91.7% 11.8%, 100% 46.4%, 97.4% 82.2%, 92.5% 84.9%, 75.7% 64%, 55.3% 47.5%, 46.5% 49.4%, 45% 62.9%, 50.3% 87.2%, 21.3% 64.1%, 0.1% 100%, 5.4% 51.1%, 21.4% 63.9%, 58.9% 0.2%, 73.6% 51.7%)">
                </div>
            </div>
            <div class="mx-auto max-w-7xl px-6 pb-24 pt-10 sm:pb-32 lg:flex lg:px-8 lg:py-40">
                <div class="mx-auto max-w-2xl flex-shrink-0 lg:mx-0 lg:max-w-xl lg:pt-8">
                    <img class="h-11"
                        src="https://res.cloudinary.com/dtsuvx8dz/image/upload/v1706986565/hqatxpsjdg3zeql20jfe.png"
                        alt="Your Company">
                    <div class="mt-24 sm:mt-32 lg:mt-16">
                        <a href="#" class="inline-flex space-x-6">
                            <span
                                class="rounded-full bg-blue-500/10 px-3 py-1 text-sm font-semibold leading-6 text-blue-400 ring-1 ring-inset ring-blue-500/20">What's
                                new</span>
                            <span
                                class="inline-flex items-center space-x-2 text-sm font-medium leading-6 text-gray-300">
                                <span>Just shipped v1.0</span>
                                <svg class="h-5 w-5 text-gray-500" viewBox="0 0 20 20" fill="currentColor"
                                    aria-hidden="true">
                                    <path fill-rule="evenodd"
                                        d="M7.21 14.77a.75.75 0 01.02-1.06L11.168 10 7.23 6.29a.75.75 0 111.04-1.08l4.5 4.25a.75.75 0 010 1.08l-4.5 4.25a.75.75 0 01-1.06-.02z"
                                        clip-rule="evenodd" />
                                </svg>
                            </span>
                        </a>
                    </div>
                    <h1 class="mt-10 text-4xl font-bold tracking-tight text-white sm:text-5xl">Revolutionize Your
                        Recruitment with Next-Gen Resume Parsing</h1>
                    <p class="mt-6 text-lg leading-8 text-gray-300">Unlock the potential of every application with our
                        advanced resume parser, designed to enhance the speed and accuracy of
                        your hiring decisions.</p>
                    <div class="mt-10 flex items-center gap-x-6">
                        <form action="/process" method="post" enctype="multipart/form-data">
                            <div
                                class="mt-10 flex flex-col justify-start items-start sm:flex-row sm:items-center  gap-x-6">
                                <button type="submit"
                                    class=" my-2 bg-blue-500 px-8 rounded-2xl py-2.5 text-sm font-semibold text-white shadow-sm hover:bg-blue-400/90 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-indigo-600">Process</button>
                                <input type="file" name="pdf_doc" id="pdf_doc" accept=".pdf" class=" drop-shadow-md bg-white/10 font-semibold leading-6 text-gray-900 border border-blue-300 py-2 px-4 rounded-2xl block w-full text-sm text-slate-500
                                                        file:mr-4 file:py-2 file:px-4
                                                        file:rounded-full file:border-0
                                                        file:text-sm file:font-semibold
                                                        file:bg-blue-50 file:text-blue-400
                                                        hover:file:bg-blue-100" type="file">

                            </div>
                        </form>
                    </div>
                </div>
                <div
                    class="mx-auto mt-16 flex max-w-2xl sm:mt-24 lg:ml-10 lg:mr-0 lg:mt-40 lg:max-w-none lg:flex-none xl:ml-32">
                    <div class="max-w-3xl flex-none sm:max-w-5xl lg:max-w-none">
                        <img src="https://res.cloudinary.com/dtsuvx8dz/image/upload/v1716357077/o1imiun4wwcpia9uucgs.gif"
                            alt="App screenshot" width="2432" height="1442"
                            class="w-[15rem] rounded-md bg-white/5 shadow-2xl ring-1 ring-white/10">
                    </div>
                </div>
            </div>


            <div class=" w-screen h-full pb-8">
                <div class="flex flex-col justify-center items-center text-white">
                    <div class="w-full max-w-7xl">
                        {% if data %}
                        {% if data.error %}
                        <div class="bg-red-500/10 border border-red-500/20 rounded-lg p-4 mb-4">
                            <h3 class="text-red-400 font-semibold">Error</h3>
                            <p class="text-gray-300">{{ data.message }}</p>
                            <p class="text-gray-400 text-sm">{{ data.error }}</p>
                        </div>
                        {% else %}
                        <!-- ATS Analysis Section -->
                        <div class="bg-blue-500/10 border border-blue-500/20 rounded-lg p-6 mb-6">
                            <h2 class="text-2xl font-bold text-blue-400 mb-4">ATS Analysis</h2>

                            <!-- Score Card -->
                            <div class="mb-6">
                                <div class="bg-gray-800/50 rounded-lg p-6 flex items-center justify-between">
                                    <div>
                                        <h3 class="text-xl font-semibold text-white mb-2">ATS Compatibility Score</h3>
                                        <p class="text-gray-300">How well your resume matches ATS requirements</p>
                                    </div>
                                    <div class="text-center">
                                        <div id="scoreCircle"
                                            class="w-24 h-24 rounded-full border-4 border-blue-500 flex items-center justify-center">
                                            <span id="scoreValue" class="text-3xl font-bold text-white">0</span>
                                        </div>
                                        <p class="text-sm text-gray-400 mt-2">out of 100</p>
                                    </div>
                                </div>
                            </div>

                            <!-- Analysis Details -->
                            <div class="prose prose-invert max-w-none space-y-6">
                                <div id="atsAnalysis" class="space-y-4">
                                    <!-- Content will be populated by JavaScript -->
                                </div>
                            </div>
                        </div>

                        <!-- Parsed Resume Data Section -->
                        <div class="bg-gray-800/50 border border-gray-700 rounded-lg p-6">
                            <h2 class="text-2xl font-bold text-white mb-4">Parsed Resume Data</h2>
                            <div id="parsedData" class="space-y-4"></div>
                        </div>
                        {% endif %}
                        {% endif %}
                    </div>
                </div>
            </div>
        </div>

        {% if data and not data.error %}
        <script>
            function displayParsedData(data) {
                // Extract and display ATS score
                const atsAnalysis = data.ats_analysis;
                const scoreMatch = atsAnalysis.match(/Score:\s*(\d+)/);
                if (scoreMatch) {
                    const score = parseInt(scoreMatch[1]);
                    const scoreValue = document.getElementById('scoreValue');
                    const scoreCircle = document.getElementById('scoreCircle');

                    // Update score
                    scoreValue.textContent = score;

                    // Update circle color based on score
                    if (score >= 80) {
                        scoreCircle.style.borderColor = '#22c55e'; // green
                    } else if (score >= 60) {
                        scoreCircle.style.borderColor = '#eab308'; // yellow
                    } else {
                        scoreCircle.style.borderColor = '#ef4444'; // red
                    }
                }

                // Format and display ATS analysis
                const atsAnalysisDiv = document.getElementById('atsAnalysis');
                const sections = atsAnalysis.split('\n\n');

                sections.forEach(section => {
                    if (section.trim()) {
                        const sectionDiv = document.createElement('div');
                        sectionDiv.className = 'bg-gray-800/30 rounded-lg p-4';

                        // Split section into title and content
                        const [title, ...content] = section.split('\n');

                        // Create title
                        const titleDiv = document.createElement('h3');
                        titleDiv.className = 'text-lg font-semibold text-blue-400 mb-2';
                        titleDiv.textContent = title;
                        sectionDiv.appendChild(titleDiv);

                        // Create content
                        const contentDiv = document.createElement('div');
                        contentDiv.className = 'text-gray-300 space-y-2';
                        content.forEach(line => {
                            if (line.trim()) {
                                const p = document.createElement('p');
                                p.textContent = line.trim();
                                contentDiv.appendChild(p);
                            }
                        });
                        sectionDiv.appendChild(contentDiv);

                        atsAnalysisDiv.appendChild(sectionDiv);
                    }
                });

                // Display parsed resume data
                const parsedDataDiv = document.getElementById("parsedData");
                const parsedData = data.parsed_data;

                function createSection(title, content) {
                    const section = document.createElement('div');
                    section.className = 'bg-gray-700/30 rounded-lg p-4';

                    const sectionTitle = document.createElement('h3');
                    sectionTitle.className = 'text-lg font-semibold text-blue-400 mb-2';
                    sectionTitle.textContent = title;
                    section.appendChild(sectionTitle);

                    if (typeof content === 'object') {
                        const contentDiv = document.createElement('div');
                        contentDiv.className = 'ml-4 space-y-2';
                        for (const [key, value] of Object.entries(content)) {
                            if (value !== null && value !== '') {
                                const item = document.createElement('div');
                                item.className = 'text-gray-300';
                                if (Array.isArray(value)) {
                                    item.innerHTML = `<strong>${key}:</strong> ${value.join(', ')}`;
                                } else if (typeof value === 'object') {
                                    item.innerHTML = `<strong>${key}:</strong> ${JSON.stringify(value, null, 2)}`;
                                } else {
                                    item.innerHTML = `<strong>${key}:</strong> ${value}`;
                                }
                                contentDiv.appendChild(item);
                            }
                        }
                        section.appendChild(contentDiv);
                    } else {
                        const contentP = document.createElement('p');
                        contentP.className = 'text-gray-300';
                        contentP.textContent = content;
                        section.appendChild(contentP);
                    }

                    return section;
                }

                // Display personal info
                if (parsedData.personal_info) {
                    parsedDataDiv.appendChild(createSection('Personal Information', parsedData.personal_info));
                }

                // Display education
                if (parsedData.education && parsedData.education.length > 0) {
                    const educationSection = createSection('Education', {});
                    const educationContent = document.createElement('div');
                    educationContent.className = 'ml-4 space-y-2';
                    parsedData.education.forEach(edu => {
                        const eduDiv = document.createElement('div');
                        eduDiv.className = 'text-gray-300';
                        eduDiv.innerHTML = `
                        <strong>${edu.degree}</strong> - ${edu.institute}<br>
                        ${edu.board_university} - ${edu.year}<br>
                        Score: ${edu.score}
                    `;
                        educationContent.appendChild(eduDiv);
                    });
                    educationSection.querySelector('div').appendChild(educationContent);
                    parsedDataDiv.appendChild(educationSection);
                }

                // Display skills
                if (parsedData.skills) {
                    parsedDataDiv.appendChild(createSection('Skills', parsedData.skills));
                }

                // Display experience
                if (parsedData.experience && parsedData.experience.length > 0) {
                    const experienceSection = createSection('Experience', {});
                    const experienceContent = document.createElement('div');
                    experienceContent.className = 'ml-4 space-y-4';
                    parsedData.experience.forEach(exp => {
                        const expDiv = document.createElement('div');
                        expDiv.className = 'text-gray-300';
                        expDiv.innerHTML = `
                        <strong>${exp.title}</strong> at ${exp.company}<br>
                        ${exp.location} - ${exp.duration}<br>
                        <ul class="list-disc ml-4 mt-2">
                            ${exp.achievements.map(achievement => `<li>${achievement}</li>`).join('')}
                        </ul>
                    `;
                        experienceContent.appendChild(expDiv);
                    });
                    experienceSection.querySelector('div').appendChild(experienceContent);
                    parsedDataDiv.appendChild(experienceSection);
                }

                // Display projects
                if (parsedData.projects && parsedData.projects.length > 0) {
                    const projectsSection = createSection('Projects', {});
                    const projectsContent = document.createElement('div');
                    projectsContent.className = 'ml-4 space-y-4';
                    parsedData.projects.forEach(project => {
                        const projectDiv = document.createElement('div');
                        projectDiv.className = 'text-gray-300';
                        projectDiv.innerHTML = `
                        <strong>${project.name}</strong><br>
                        Technologies: ${project.technologies.join(', ')}<br>
                        ${project.links.live_site ? `<a href="${project.links.live_site}" class="text-blue-400 hover:text-blue-300">Live Site</a> | ` : ''}
                        ${project.links.github_repo ? `<a href="${project.links.github_repo}" class="text-blue-400 hover:text-blue-300">GitHub Repo</a>` : ''}
                        <ul class="list-disc ml-4 mt-2">
                            ${project.achievements.map(achievement => `<li>${achievement}</li>`).join('')}
                        </ul>
                    `;
                        projectsContent.appendChild(projectDiv);
                    });
                    projectsSection.querySelector('div').appendChild(projectsContent);
                    parsedDataDiv.appendChild(projectsSection);
                }
            }

            displayParsedData({{ data| tojson }});
        </script>
        {% endif %}
    </body>

</html>